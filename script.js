var data = [
    {
        id: `a-algemene-broadcast`,
        nederlands: {
            titel: `Ga in de ALGEMENE TELEGRAM BROADCAST`,
            beschrijving: `Dat is <a href="https://t.me/+-1BG92MkKMk2ODc0">dit telegramkanaal</a> met de titel "Stop Sub #12".`,
            toelichting: `Voor veel acties, en ook voor deze <span class="a-12">A12-actie</span>, is er een grote <em>signal of telegram-groep</em> waar belangrijke mededelingen worden gepost.`,
        },
        engels: {
            titel: `Join the GENERAL TELEGRAM BROADCAST`,
            beschrijving: `It's <a href="https://t.me/+-1BG92MkKMk2ODc0">this telegram group</a> with the title "Stop Sub #12".`,
            toelichting: `For most actions, there is a big broadcast channel where important announcement are made. Always join them, and read the information carefully.`,
        }
    },
    {
        id: `a-vingergroep`,
        nederlands: {
            titel: `Zorg ervoor dat je in een VINGER signaalgroep zit`,
            beschrijving: `Dat is de signal groep waar je als het goed is al in zit. Zo niet, neem dan contact op met Stardust!`,
            toelichting: `Bij grote acties wordt er soms gewerkt met 'vingers': dat zijn groepen die samen voorbereiden en naar de actielocatie lopen. Dit vergroot de veiligheid en de kans dat zo veel mogelijk rebellen op de actie aankomen.`,
        },
        engels: {
            titel: `Make sure to be in a FINGER signal group`,
            beschrijving: `It is the signal-group that you probably are in already. If not, please contact Stardust!`,
            toelichting: `Larger actions sometimes use 'fingers'. These are groups that prepare for the action together and move towards the place of action together. This increases security and our chances of success.`,
        }
    },
    {
        id: `a-welzijntraining`,
        nederlands: {
            titel: `Volg een WELZIJN TRAINING`,
            beschrijving: `Als je dat al eerder hebt gedaan, hoeft dat niet nogmaals. Als u er geen kunt volgen, doe dan donderdag na de briefing mee aan de spoedcursus welzijn.`,
            toelichting: `U kunt ook de dia's van dit document doornemen (bekijk de aantekeningen van de spreker) om de belangrijkste informatie te krijgen: https://xrb.link/ez8Ht2Qu.`,
        },
        engels: {
            titel: `Do a wellbeing TRAINING`,
            beschrijving: `If you've done one before, you don't need to do it again. In case you cannot follow one join the wellbeing crash course this Thursday right after the briefing.`,
            toelichting: `You can also read go through the slides (check the speaker notes) of this document to get the most important information : https://xrb.link/ez8Ht2Qu.`,
        }
    },
    {
        id: `a-groen-hesje`,
        nederlands: {
            titel: `Haal en breng een GROEN HESJE`,
            beschrijving: `Als je een groen vest hebt, of iemand kent die je eigen vest mee kan nemen (misschien even checken), geweldig! Zo niet, dan neemt Dandelion contact met je op. Maak per vinger plannen wie de vesten kan krijgen en van waar`,
            toelichting: `Als je er geen hebt en er is nog geen contact met je opgenomen, stuur dan een bericht naar Dandelion +33 6 37 66 33 23 om iets te regelen.`,
        },
        engels: {
            titel: `Get and bring a GREEN VEST`,
            beschrijving: `If you have a green vest, or know someone that can bring you own (maybe double check with them), great! If not, Dandelion will contact you about it. Make plans per finger of who can get the vests and from where`,
            toelichting: `If you don't have one and haven't been contacted yet, please send a message to Dandelion +33 6 37 66 33 23 to arrange something`,
        }
    },
    {
        id: `a-presenteer-jezelf`,
        nederlands: {
            titel: `Presenteer jezelf als welzijn in je vinger`,
            beschrijving: `Schrijf een korte boodschap om jezelf voor te stellen zodat de rest van je vinger weet wie de welzijnsrebellen in hun vingers zijn. `,
            toelichting: `Er is een voorbeeld dat werd gedeeld in het welzijn Telegram dat je kunt gebruiken. Als je wilt, kun je ook rebellen die zich gestrest voelen voor de actie aanbieden om een praatje met ze te maken (werkt als je zelf een beetje ervaren bent).`,
        },
        engels: {
            titel: `Present yourself as wellbeing in your finger`,
            beschrijving: `Write a short message to present yourself so the rest of your finger knows who the wellbeing rebels in their fingers are.`,
            toelichting: `There is an example that was shared in the wellbeing Telegram that you can use. If you want to, you can also offer rebels who feel stressed before the action to have a chat with them (works if you are yourself a bit experienced).`,
        }
    },
    {
        id: `a-welzijn-briefing`,
        nederlands: {
            titel: `Volg de ALGEMENE BRIEFING`,
            beschrijving: ` Er zal een welzijnsbriefing van ongeveer een uur zijn op donderdag om 19 uur.`,
            toelichting: `De briefing zal de belangrijkste punten over welzijn voor de A12 bevatten. Als u niet aanwezig kunt zijn, raadpleeg dan dit document: https://xrb.link/E1C22ER2Aa8`,
        },
        engels: {
            titel: `Follow the WELLBEIN BRIEFING`,
            beschrijving: `There will be a wellbeing briefing of about an hour on Thursday at 19H`,
            toelichting: `The briefing will present the most important points about wellbeing for the A12. If you cannot attend please check this document: https://xrb.link/E1C22ER2Aa8`,
        }
    },
    {
        id: `a-rol`,
        nederlands: {
            titel: `Kies een rol`,
            beschrijving: `Ga door de lijst van rollen en vind iets dat geschikt lijkt voor u.`,
            toelichting: `Co√∂rdineer met het andere welzijn in je vinger om te beslissen wie de snacks mag kopen, en hoe je ze met elkaar wilt verdelen.`,
        },
        engels: {
            titel: `Choose a role`,
            beschrijving: `Go through the list of roles and find something that seem suitable for you`,
            toelichting: `Coordinate with the other wellbeing in your finger to decide who can buy the snacks, and how you want to distribute it with one another`,
        }
    },
    {
        id: `tas`,
        nederlands: {
            titel: `Pak je tas in`,
            beschrijving: `Pak uw tas in volgens de rol die u gaat vervullen`,
            toelichting: `Bekijk hier de paklijst voor welzijn en vergeet niet in te pakken volgens de algemene paklijst https://xrb.link/Hb8eGq`,
        },
        engels: {
            titel: `Pack your bag`,
            beschrijving: `Pack your bag according to the role you are planning to do`,
            toelichting: `Check the packing list here for wellbeing and don't forget to pack according to the general packing list https://xrb.link/Hb8eGq `,
        }
    },
     {
        id: `a-zen`,
        nederlands: {
            titel: `Je bent er KLAAR voor!`,
            beschrijving: `Neem nog wat rust. Bedenk waarom je het ook alweer doet. We hebben een goed verhaal, we zijn met z'n duizenden. Misschien vind je het spannend. Maar het wordt ook heel gaaf.`,
            toelichting: `Vergeet niet eerst voor jezelf te zorgen, en het is altijd goed om pauzes te nemen!`,
        },
        engels: {
            titel: `You are READY to go!`,
            beschrijving: `Take a deep breath, remember why you are doing this. We're doing this for an important cause, and we're getting more support everyday. Try to also have fun!`,
            toelichting: `Remember to take care of yourself first, and it is always ok to take breaks!`,
        }
    },
]

function start()
{
    let actiepunten = document.getElementById("actiepunten");

    actiepunten.innerHTML = ""; // bye

    let n = data.length;

    var e = document.getElementById("taalvoorkeur");
    var value = e.value;


    if (value == 'nederlands') {
        for (let i = 0; i < n; i++)
        {
            var html = template_actiepunt(data[i].id, data[i].nederlands.titel, data[i].nederlands.beschrijving, data[i].nederlands.toelichting);
            actiepunten.insertAdjacentHTML("beforeend", html);

            if (i != n-1)
            {
                actiepunten.insertAdjacentHTML("beforeend", template_pijl());
            }
        }
    } else {
        for (let i = 0; i < n; i++)
        {
            var html = template_actiepunt(data[i].id, data[i].engels.titel, data[i].engels.beschrijving, data[i].engels.toelichting);
            actiepunten.insertAdjacentHTML("beforeend", html);

            if (i != n-1)
            {
                actiepunten.insertAdjacentHTML("beforeend", template_pijl());
            }
        }
    }
}

function update()
{
    let items = document.getElementsByClassName("actiepunt");

    let is_visible = true;
    let i = 0;

    for (let item of items) {

        let is_checked = item.querySelector(".checkbox").checked;

        // Show or hide the element.
        if (is_visible)
        {
            item.classList.remove("hidden");
            item.getElementsByClassName("checkbox")[0].disabled = false;
            if (is_checked)
            {
                item.classList.add("done");
            }
            else
            {
                item.classList.remove("done");
            }
        }
        else
        {
            item.classList.add("hidden");
            item.getElementsByClassName("checkbox")[0].disabled = true;

            item.classList.remove("done");
        }

        // When we meet an unchecked item, disable visibility for all next items.

        // I've disabled this for now, so people can cross things off, non-sequential.
        // if (!is_checked)
        // {
        //     is_visible = false;
        // }

        i++;
    };
}

function clear()
{
    let items = document.getElementsByClassName("actiepunt");

    for (let item of items) {
        checkbox = item.querySelector(".checkbox");
        checkbox.checked = false;
    }
}

function reset()
{
    clear();
    save_to_cookies();

    start();
    update();

    document.documentElement.scrollTop = 0;
}

function save_to_cookies()
{
    let items = document.getElementsByClassName("actiepunt");

    for (let item of items) {
        checkbox = item.querySelector(".checkbox");
        let is_checked = checkbox.checked;

        set_cookie(String(checkbox.id), String(is_checked));
    }
}

function load_from_cookies()
{
    let items = document.getElementsByClassName("actiepunt");

    for (let item of items) {
        checkbox = item.querySelector(".checkbox");

        let v = get_cookie(checkbox.id);

        if (v == String(true))
        {
            checkbox.checked = true;
        }
        else
        {
            checkbox.checked = false;
        }
    }
}

// Simply copy-pasting this from w3schools:

function set_cookie(cname, cvalue) {
    let days = 40;
    const d = new Date();
    d.setTime(d.getTime() + (days*24*60*60*1000));
    let expires = "expires="+ d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function get_cookie(cname) {
    let name = cname + "=";
    let decodedCookie = decodeURIComponent(document.cookie);
    let ca = decodedCookie.split(';');
    for(let i = 0; i <ca.length; i++) {
      let c = ca[i];
      while (c.charAt(0) == ' ') {
        c = c.substring(1);
      }
      if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
      }
    }
    return "";
}

function template_actiepunt(id, titel, beschrijving, toelichting)
{
    return `
        <div class="actiepunt" id=${id}>
            <div class="box">
            <p class="titel titelfont">${titel}</p>
            <p class="beschrijving">${beschrijving}</p>
            <div class="check">
                <input class="checkbox" type="checkbox" id="${id}" onchange="save_to_cookies(); update()">
                <label class="titelfont" for="${id}">Check</label>
            </div>
            </div>
            <div class="inklapbaar">
            <div class="box toevoeging">
                <p class="toelichting">${toelichting}</p>
            </div>
            </div>
        </div>`
}



function template_pijl()
{
    return `
        <img class="pijl" src="img/arrow_down_thin_120.png">`
}


window.addEventListener('load', function () {
    start();
    load_from_cookies();
    update();
  })
